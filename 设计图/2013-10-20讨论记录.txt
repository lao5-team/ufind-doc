[21:11:59] yh: hello
[21:12:04] 坤 坤: 哈罗
[21:12:19] yh: 发了两封邮件
[21:12:31] 坤 坤: qq邮箱？
[21:12:53] yh: 不是一直163吗
[21:13:27] yh: 另外客户端现在的分支是demo2.0
[21:14:05] 坤 坤: 好
[21:15:19] yh: 可以编译运行试一下
[21:15:27] 坤 坤: 好
[21:16:12] yh: 还有这个功能：
[21:16:17] yh:    1.1 通过QQ，微信（只选择其中一个）登陆，并在后台映射一个ID进行注册。
       解释：
       客户端用QQ SDK来进行登录，获取一个对应QQ号的openID，以此ID来映射用户名，例如返回的openID是1234567，则
       对应到我们应用的ID是com.tencent.qq.1234567
[21:16:25] yh: 你看看有没有问题
[21:18:16] 坤 坤: 是用户id是com.tencent.qq.1234567？
[21:18:33] yh: 嗯，类似这种格式
[21:18:42] 坤 坤: 那密码呢？
[21:18:55] yh: QQ登录不用密码
[21:19:12] yh: 只有一个临时的key
[21:19:18] 坤 坤: 哦，那还是用qq的oauth方式？
[21:19:32] yh: 对
[21:19:56] 坤 坤: qq登录也用密码吧，如果不用密码那不是我可以用你的号登录？
[21:19:57] yh: 两种方式注册和登录，自己的和QQ的
[21:21:23] yh: QQ登录的时候会返回一个openID和一个token
[21:21:35] yh: 10-20 19:04:19.414: V/LoginActivity(24358): {"ret":"0","pay_token":"2BB8413F6D3A9D773DEBB5C70B103330",
"pf":"openmobile_android","appid":"100579301",
"openid":"286487052E99D2418379BB6494AE8289","expires_in":"7776000",
"pfkey":"96db2be98d02d2e6ced2cc8c500c61f4","access_token":"A876FD211AD78443EAD035824E82C809"}
[21:21:41] yh: openid就是用户名
[21:21:41] 坤 坤: 那不是登录用密码吗
[21:21:57] yh: access_token就相当于密码
[21:22:20] yh: 但第一我们要那个token没用
[21:22:26] yh: 第二那个token会超时
[21:22:37] 坤 坤: 同一个qq号在不同的机器上登录得到的id号是一样的吗
[21:22:48] yh: 是的
[21:23:17] 坤 坤: 确定？id是通过qq怎么生成的？
[21:23:38] yh: 你在你那边试试
[21:23:48] yh: 运行一下我的程序
[21:23:53] 坤 坤: demo2？
[21:24:31] yh: 用我的小号登录 2070257500
[21:24:34] yh: yh841125
[21:25:04] yh: 然后看TAG为LoginActivity的返回值
[21:25:16] yh: 不是，是日志
[21:26:21] yh: 另一个问题，注册的请求怎么写？
[21:27:14] 坤 坤: 怎么发给你附件？
[21:28:39] *** yh 发送 IMG_20102013_212839.png ***
[21:29:06] yh: 会话-》发送-》文件
[21:29:17] *** 坤 坤 发送 Connect_Android_SDK_V1.5.0.zip ***
[21:29:55] yh: 说了，已经有了
[21:30:08] 坤 坤: 没看到新的分支啊
[21:30:43] 坤 坤: 请求要定个协议
[21:32:08] yh: 今天能定出来不？
[21:32:20] 坤 坤: 可以啊
[21:32:39] 坤 坤: 新的分支看不到
[21:35:05] yh: git branch没有？
[21:35:31] 坤 坤: C:\Users\renlikun\Documents\GitHub\ufind [demo_v1.0-yh +1 ~1 -0 !]> git branch
  demo-v1.0
* demo_v1.0-yh
C:\Users\renlikun\Documents\GitHub\ufind [demo_v1.0-yh +1 ~1 -0 !]>
[21:35:42] 坤 坤: 没有
[21:35:51] yh: 是不是要更新一下？
[21:36:08] 坤 坤: 更新了啊
[21:36:36] 坤 坤: 你那里能看到不？
[21:37:58] yh: sure
[21:38:04] 坤 坤: 嗯
[21:38:22] *** yh 发送 1.png ***
[21:38:31] yh: 你去github上看看有没有
[21:38:43] 坤 坤: 看了，也没有
[21:40:07] yh: 把你git hub账号给我登一下试试
[21:40:57] *** 坤 坤 发送 11.png ***
[21:41:24] 坤 坤: 用户名renlikun
[21:41:31] 坤 坤: 密码不记得是不是123456
[21:42:25] yh: 不对
[21:42:30] yh: 你再想想
[21:42:31] 坤 坤: 831016
[21:44:59] yh: 还是不读，用户名是不是少个邮箱？
[21:45:13] 坤 坤: renlikun@gmail.com？
[21:45:22] 坤 坤: 我不记得是怎么登录的了
[21:45:28] yh: 我靠
[21:46:02] 坤 坤: 现在点开就直接登录了啊
[21:46:22] yh: 还是不对
[21:46:34] yh: 那个程序只是测试登录用的
[21:46:57] yh: 你拉到分支了？
[21:47:06] 坤 坤: 什么意思？
[21:47:10] 坤 坤: 我什么都没动啊
[21:47:28] yh: 那我也不明白你什么意思
[21:47:49] yh: 哦，你说的是github登录
[21:47:55] 坤 坤: 是的
[21:48:09] yh: 你在github上logout一下
[21:49:23] yh: 然后回忆一下
[21:49:28] 坤 坤: 有了
[21:49:36] yh: 多少？
[21:49:37] 坤 坤: 我点了一个sync的小按钮
[21:49:45] 坤 坤: 出现了demo2
[21:50:02] yh: 看。。你没有更新吧？
[21:50:16] 坤 坤: 我是在命令行里敲了git pull
[21:50:24] 坤 坤: 没用github
[21:50:32] 坤 坤: github不会用
[21:51:14] yh: 哦。。。。。
[21:51:49] yh: 你运行一下，然后定一下协议，再教我怎么写那个请求？
[21:52:52] yh: 就是类似下面这段代码的请求
[21:52:53] yh: String para = "#pwd#=123\r\n#username#=abc";
              int len = para.length();
              socket = new Socket("192.168.200.7", 8080);
              socket.setSoTimeout(3000);
              BufferedWriter wr = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream(),
                      "UTF8"));
              InputStream ins = socket.getInputStream();
              StringBuffer sb = new StringBuffer();
              sb.append("POST /login  HTTP/1.1\r\n");// 注意\r\n为回车换行
              sb.append("Accept-Language: zh-cn\r\n");
              sb.append("Connection: Keep-Alive\r\n");
              sb.append("Host:localhost\r\n");
              sb.append("Content-Length:"+len+"\r\n");
              sb.append("Content-Type: application/x-www-form-urlencoded\r\n");
              sb.append("\r\n");
              sb.append(para);
              // 接收Web服务器返回HTTP响应包
              wr.write(sb.toString());
              wr.flush();
[21:56:02] 坤 坤: 10-20 21:55:24.875: V/LoginActivity(18533): {"ret":"0","pay_token":"EF4F8CD5460753680E9969F82AC9E497","pf":"openmobile_android","appid":"100579301","openid":"2EE88ED085C269C04A74463D6B255C16","expires_in":"7776000","pfkey":"dde28e5862c1b3fd229738d2fd029d40","access_token":"1B1CDE1E1F9F9CD6E1D8B64685A87F69"}
[21:56:09] 坤 坤: 好像openid是一样的
[21:57:23] yh: 10-20 19:42:24.937: V/LoginActivity(29123): {"ret":"0","pay_token":"D7FA275DF0FFF448ABB3500CB5460408",
"pf":"openmobile_android","appid":"100579301","openid":"2EE88ED085C269C04A74463D6B255C16",
"expires_in":"7776000","pfkey":"dde28e5862c1b3fd229738d2fd029d40",
"access_token":"1B1CDE1E1F9F9CD6E1D8B64685A87F69"}
[21:58:00] yh: 必须得一样，要不然不得乱了
[21:58:09] 坤 坤: 嗯，太好了
[21:58:25] 坤 坤: 一个是协议，一个是数据库表的设计
[21:59:23] yh: 嗯，你先定
[21:59:47] 坤 坤: 根据功能和内容定数据库吧
[22:01:31] yh: 嗯
[22:01:52] 坤 坤: 首先用户信息我们都要包括哪些？
[22:04:49] yh: 你初步定一下
[22:07:40] 坤 坤: qq号、openid、头像信息、好友表id、聚会记录表id、登录方式
[22:08:01] 坤 坤: 还有其他的吗？
[22:08:36] 坤 坤: 聊天记录表id
[22:14:01] 坤 坤: are u？
[22:14:01] yh: qq号获取不到，而且你准备用它来做什么？
[22:14:24] 坤 坤: qq号没用吗？
[22:15:10] yh: 我问的是你准备用它来做什么？你就说你想干什么就行了
[22:15:29] 坤 坤: 也没啥用
[22:15:41] yh: 为啥不能问什么答什么呢？你们宇龙的好像都这样
[22:15:56] 坤 坤: 你又扯宇龙做什么呢
[22:16:23] yh: 对宇龙十分不爽
[22:16:47] 坤 坤: 那跟我们讨论的问题有什么关系呢
[22:17:33] yh: 有关系，宇龙的做事方式很差劲
[22:17:44] yh: 直接影响沟通效率
[22:17:52] 坤 坤: 你扯远了
[22:18:00] 坤 坤: 赶紧整我们的事情
[22:19:03] yh: 没扯远，以前就感觉到了，宇龙的员工不喜欢正面回答问题
[22:19:21] yh: openid要映射成我们自己的id
[22:19:42] 坤 坤: 那是不是只记录id就可以了
[22:20:04] 坤 坤: 其他的跟QQ没有任何关系
[22:20:05] yh: 是的，服务器通过注册方式进行换算
[22:21:15] yh: 然后还得有用户名字段
[22:21:50] 坤 坤: 这个注册方式是在客户端做还是服务器端做
[22:23:25] yh: 注册和登录的时候都会向服务器发一个类型，0表示通过我们的应用，1表示通过QQ
[22:24:49] 坤 坤: 那就是客户端去连qq服务器，得到id后再发给我们的服务器
[22:25:00] yh: 是的
[22:25:05] 坤 坤: ok
[22:26:27] 坤 坤: 其他
[22:27:42] yh: 用户名
[22:28:18] yh: 还没有用户名字段
[22:28:34] 坤 坤: 我们自己的id做什么用呢？
[22:29:18] yh: 说的不准确，是昵称
[22:29:34] yh: 我们自己的id不是用来做登录的吗？
[22:30:00] yh: id和password进行login
[22:30:08] 坤 坤: 昵称差不多，我说有了id为啥还要用户名
[22:30:46] yh: OK
[22:31:06] 坤 坤: 那怎么让用户知道他的用户名是什么？
[22:31:41] yh: 设置里面查看用户信息
[22:32:06] 坤 坤: 还要进设置看自己的用户名？
[22:32:41] yh: 应用里面的设置
[22:32:53] 坤 坤: 我觉得不太好
[22:33:09] 坤 坤: 不是每个用户已使用应用就会进设置的
[22:33:11] yh: 那你就显示在第一页也行啊
[22:33:41] yh: 就像qq那样
[22:33:47] yh: 或者陌陌那样
[22:33:50] yh: 都OK 啊
[22:33:56] 坤 坤: 用手机号怎么样？
[22:34:31] yh: 可以
[22:34:44] yh: 反正只是用来注册的
[22:34:49] 坤 坤: 陌陌和qq都是用户自己设置的，你的这个id是给用户加的
[22:34:51] yh: 还有登录使用
[22:35:01] yh: id是用户填写的
[22:35:14] 坤 坤: 那也行
[22:35:24] 坤 坤: 只要是用户自己写的也行
[22:35:24] yh: 我们可以提供
[22:35:32] yh: 1.通过手机号注册
[22:35:36] yh: 2.邮箱注册
[22:35:38] yh: 等等
[22:35:49] yh: 第一步就用手机号注册吧
[22:35:53] 坤 坤: 别等等，得确定
[22:36:05] yh: 没精力搞邮箱注册
[22:36:10] 坤 坤: 最后用手机号注册吧，我们没有短信通道的资源
[22:36:42] 坤 坤: 就用qq和id吧，最后视情况加手机注册，或者后面加手机号关联
[22:37:26] yh: 嗯，这个主意不错
[22:38:37] yh: 反正我估计90%都是QQ号注册了
[22:38:45] 坤 坤: 嗯
[22:38:51] 坤 坤: 还有其他的不
[22:42:02] yh: 我想想
[22:46:35] yh: [22:07] 坤 坤: 

<<< 好友表id、聚会记录表id
[22:47:06] yh: 这个具体你是如何设计的？
[22:47:53] 坤 坤: 每个用户的好友要记住吧，以前聚会的信息是不是也得保留
[22:47:58] 坤 坤: 每个做一个表
[22:49:12] yh: 那就是一个用户有一个好友列表和聚会记录列表？
[22:49:53] 坤 坤: 是的，你觉得怎么样
[22:50:53] yh: Dion，This boy is on fire
张伟、知乎用户、习之北 等人赞同
数据表三个字段
主键（自动生成）
UserID1
UserID2

注意事项
<UserID 1, UserID 2> 和 <UserID 2, UserID 1> 是一样的记录，不要重复添加
为了快速判断两个人是不是好友，可以在程序层插入数据前加一个限制 UserID1 < UserID2
为了快速得到一个人的好友列表，查询时用 UNION ALL，不是 UNION
如果为了再高效，加入缓存层（Redis 或 Memcached）
[22:51:34] yh: 我觉得他这个思路比较好，一张表就可以维护朋友关系了
[22:52:07] yh: 但是我还没有考虑到分组的情况
[22:53:05] 坤 坤: 有分组的话他这个就不好做了，分开做分组还简单一些
[22:53:24] yh: http://www.myexception.cn/mysql/333265.html
[22:58:27] 坤 坤: 嗯
[22:58:41] yh: 先按你的来吧，实现功能再说
[22:59:59] 坤 坤: 好
[23:00:08] yh: 微信都没有分组，所以先不纠结这么多
[23:00:39] 坤 坤: 微信有群
[23:01:23] yh: 等我们用户量上10万了再考虑群，分组什么的
[23:01:32] 坤 坤: 嗯
[23:01:59] yh: 那个时候再拉几个人一起讨论
[23:02:09] yh: 我这块不懂
[23:02:16] 坤 坤: 嗯
[23:02:28] 坤 坤: 还有其他的内容不
[23:02:43] 坤 坤: 头像？
[23:02:50] 坤 坤: 还是直接用qq的头像？
[23:03:05] yh: 这有一个参考http://wenku.baidu.com/view/70f0b762caaedd3383c4d372.html
[23:03:55] yh: 头像存一个图片链接就行了
[23:04:11] yh: QQ的就甭存了
[23:04:20] yh: 客户端自己去下载
[23:04:20] 坤 坤: 好
[23:04:58] yh: 表结构好扩展不？
[23:05:08] yh: 日后能随时修改不？
[23:05:18] 坤 坤: 能
[23:05:25] yh: 那就行了
[23:05:34] 坤 坤: databasehelper里面有个update函数
[23:05:45] 坤 坤: 重新它就行
[23:06:09] yh: 服务器数据库的表
[23:06:26] yh: 不是手机端的表
[23:07:00] 坤 坤: 这个很难说
[23:08:17] yh: 反正不可能一步到位
[23:08:29] 坤 坤: 那肯定的
[23:09:13] yh: 那要改表的结构咋整
[23:09:34] yh: 比如用户上1W了，我要给用户添加一个字段
[23:09:37] 坤 坤: 那只能强制用户升级了
[23:09:48] 坤 坤: 或者做兼容
[23:09:54] yh: 不是用户
[23:10:08] yh: 我是说你数据库咋办
[23:10:31] yh: 服务器的数据库怎么升级？
[23:10:35] 坤 坤: 对呀 ，要用户强制升级到2.0的客户端，这样来满足服务器数据库升级的要求
[23:10:48] 坤 坤: 我是指当数据库无法做到兼容的时候
[23:12:24] yh: 如果只添加字段，客户端不用改，如果修改或者删除字段，客户端就得改了
[23:12:37] yh: 就得升级了
[23:12:52] 坤 坤: 是的
[23:13:08] 坤 坤: 删除其实可以不做，忽略就可以了
[23:13:25] yh: 修改也没有必要
[23:13:33] 坤 坤: 是的
[23:13:54] yh: 除非类型变了，这种情况概率很低
[23:14:12] 坤 坤: 这个一般不会吧
[23:14:19] yh: 一般不会
[23:14:30] yh: 二班会
[23:14:31] 坤 坤: 或者我们有较大的升级改版
[23:14:53] yh: 较大升级直接发不新apk了
[23:15:12] yh: 那就只添加就行了
[23:15:25] 坤 坤: 再想想还有没有别的
[23:16:12] yh: 你看看返回的结果能不能做成JSONObject，qq就是这样的，相当好用
[23:17:02] yh: 性别？年龄？暂时不用
[23:17:07] 坤 坤: 这个是不是要结合jsp来做？
[23:17:29] 坤 坤: 那些不用，你的朋友你会不知道性别和大概年龄？
[23:18:00] yh: 很多都不知道
[23:18:29] yh: 但是聚会的好友一般都是真实好友
[23:18:33] 坤 坤: 是的
[23:19:09] yh: 但是存一个还是会精确一些
[23:19:33] 坤 坤: 学填吧
[23:19:34] yh: 特别是昵称和头像都火星的用户
[23:19:44] yh: 反正第一版不上
[23:19:59] 坤 坤: 好
[23:20:12] yh: 第一阶段只做核心功能
[23:20:35] 坤 坤: 总结一下
[23:20:36] 坤 坤: 1._id
2.openid
3.ownid
4.userid
5.userpwd
6.frindsid
7.recordid
8.picture
[23:20:41] yh: 只要能用就行了，体验什么的正式上线再搞
[23:21:18] 坤 坤: 体验在内部试用阶段搞
[23:21:20] yh: ownid是什么？
[23:21:52] yh: 嗯，就是正式上线之前搞
[23:22:02] 坤 坤: 我们自己生成的id
[23:22:16] yh: userid就是昵称？
[23:22:44] 坤 坤: 是的
[23:22:49] 坤 坤: 不是
[23:23:05] 坤 坤: 是的
[23:23:08] 坤 坤: 是
[23:23:28] yh: 好的，那你赶紧休息吧
[23:23:57] 坤 坤: 好
[23:23:59] yh: 讨论结束，周二之前争取把注册和登录搞定
[23:24:17] 坤 坤: 好
[23:24:23] yh: 你再告我怎么发数据给你
[23:24:58] 坤 坤: 我明天想想，晚上再说
[23:25:22] yh: 是不是都得这种格式？
[23:25:23] yh:               sb.append("POST /login  HTTP/1.1\r\n");// 注意\r\n为回车换行
              sb.append("Accept-Language: zh-cn\r\n");
              sb.append("Connection: Keep-Alive\r\n");
              sb.append("Host:localhost\r\n");
              sb.append("Content-Length:"+len+"\r\n");
              sb.append("Content-Type: application/x-www-form-urlencoded\r\n");
              sb.append("\r\n");
[23:25:51] yh: 然后填写参数？              sb.append(para);
[23:26:11] 坤 坤: 是的，这个是连接的方式
[23:26:55] yh: 行
[23:27:12] yh: 明白了
[23:27:25] 坤 坤: 那我先睡了
[23:27:40] yh: 嗯，赶紧去休息吧，别斗地主
[23:27:54] 坤 坤: 斗毛啊
[23:28:20] yh: 毛也别斗
[23:28:27] yh: 我也撤了
[23:28:35] 坤 坤: 88
[23:29:15] yh: 88